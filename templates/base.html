{% load i18n timeslots_filters %}
<!doctype html>
<head>
    <meta charset="utf-8">
    <title>KRONOS Titan GmbH - {% trans "Timeslots" %}</title>
    <meta name="description" content="KRONOS Timeslots">
    <meta name="author" content="Lutz Moppert">
    <!--[if lt IE 9]>
        <script type="text/javascript" src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery-ui-1.8.20.custom.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.ui.datepicker-{{ user.userprofile.language }}.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-alert.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-collapse.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-dropdown.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-tooltip.js"></script>
    <script type="text/javascript">
        $(function(){
            // Datepicker
            $('#datepicker').datepicker({ 
                onSelect: function(dateText, inst) { 
                    window.location = "/timeslots/station/{{ station.id }}/date/" + dateText + "/{{ target  }}/" 
                },
                {% if not station.opened_on_weekend %}beforeShowDay: $.datepicker.noWeekends,{% endif %}
                dateFormat: 'yy-mm-dd'
            });
            $('#datepicker').datepicker('setDate', '{{ date }}');
            //hover states on the static widgets
            $('#dialog_link, ul#icons li').hover(
                function() { $(this).addClass('ui-state-hover'); },
                function() { $(this).removeClass('ui-state-hover'); }
            );
        });
    </script>
    <link type="text/css" href="{{ STATIC_URL }}/img/favicon.ico" rel="shortcut icon">
    <link type="text/css" href="{{ STATIC_URL }}css/bootstrap.css" rel="stylesheet">
    <link type="text/css" href="{{ STATIC_URL }}css/bootstrap-responsive.css" rel="stylesheet">
    <link type="text/css" href="{{ STATIC_URL }}css/custom-theme/jquery-ui-1.8.20.custom.css" rel="stylesheet">
    <link type="text/css" href="{{ STATIC_URL }}css/timeslots.css" rel="stylesheet">
    {% block extra_head %}{% endblock %}
</head>

<body> 
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <span class="span3"><a class="brand" href="{% url timeslots_home %}">{% trans "Timeslots" %}</a></span>
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="nav-collapse collapse">
                {% if station %}
                    <span class="pull-left">
                        <form id="station_picker" class="navbar-form" action="/timeslots/station/" method="post">{% csrf_token %}
                            <select id="selectedStation" name="selectedStation" class="span4" onChange="this.form.submit()">
                                {% for curr_station in user.userprofile.stations.all %}
                                    <option value="{{ curr_station.id }}" {% ifequal curr_station.id station.id %}selected{% endifequal %}> {{ curr_station.longname }} </option>
                                {% endfor %}
                            </select>
                            <input type="hidden" name="currentDate" id="currentDate" value="{{ date }}">
                        </form>
                    </span>
                    {% if user|in_group:"administrator,loadmaster" %}
                    <ul class="nav"><li><a href="{% url timeslots_station_blocking station.id %}">{% trans "Block slots" %}</a></li></div>
                    {% endif %}
                {% endif %}
                {% if user.is_authenticated %}{% include "timeslots/user_menu.html" %}{% endif %}
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span3">
                {% block sidebar %} 
                <form id="sidebar" action="." method="post">{% csrf_token %}
                    {% if station.dock_set.count > 1 %}<div class="control-group section"> 
                        <label class="control-label" for="selectedDocks"><strong>{% trans "Choose dock" %}</strong></label> 
                        <div class="controls">
                            {% for dock in station.dock_set.all %}<label class="checkbox">
                                <input type="checkbox" name="selectedDocks" value="{{ dock.id }}" {% for d, b in docks %}{% if d == dock.name %}checked="checked"{% endif %}{% endfor %}>
                                {{ dock.name }}
                            </label>{% endfor %}
                        </div>
                        <button type="submit" class="btn btn-primary">{% trans "Apply filter" %}</button>
                    </div>{% endif %}
                    <div id="datepicker"></div>
                </form>
                {% endblock %}

                <div id="kronoslogo">
                    <a href="http://kronos.de/"><img src="{{ STATIC_URL }}img/logo.png" alt="KRONOS TITAN GmbH"></a>
                </div>
            </div>
            <div class="span9"> 
                {% if messages %}
                {% for message in messages %}
                {% ifequal message.tags 'error' %}<div class="alert alert-error"><strong>{% trans "Error: " %}</strong>{% endifequal %}
                {% ifequal message.tags 'warning' %}<div class="alert alert-warning"><strong>{% trans "Warning: " %}</strong>{% endifequal %}
                {% ifequal message.tags 'info' %}<div class="alert alert-info"><strong>{% trans "Info: " %}</strong>{% endifequal %}
                {% ifequal message.tags 'success' %}<div class="alert alert-success"><strong>{% trans "Success: " %}</strong>{% endifequal %}
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    <br />{{ message }}
                </div>
                {% endfor %}
                {% endif %}
                {% block content %}{% trans "Empty page" %}{% endblock %} 
            </div>
        </div>
    </div>

    <footer class="footer">
        <p class="pull-right">
            &copy; <a href="http://kronos.de">KRONOS TITAN GmbH</a> 2012
        </p>
    </footer>

</div> <!-- container -->

</body>
</html>
